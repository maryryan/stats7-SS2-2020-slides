beta1 <- rnorm(1,4,2)
beta0 <- rnorm(1,1,1)
x <- sort(x)
y <- beta0+beta1*x + c(rnorm(20,0,3), rnorm(20,5,10), rnorm(20,15,15))
xy.df <- cbind(x, y)
colnames(xy.df) <- c("x", "y")
xy.df <- as.data.frame(xy.df)
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point()+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
theme_minimal()
x <- rnorm(60,0,1)
beta1 <- rnorm(1,4,2)
beta0 <- rnorm(1,1,1)
x <- sort(x)
y <- beta0+beta1*x + c(rnorm(20,0,3), rnorm(20,5,10), rnorm(20,15,15))
xy.df <- cbind(x, y)
colnames(xy.df) <- c("x", "y")
xy.df <- as.data.frame(xy.df)
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point()+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
theme_minimal()
x <- rnorm(60,0,1)
beta1 <- rnorm(1,4,2)
beta0 <- rnorm(1,1,1)
x <- sort(x)
y <- beta0+beta1*x + c(rnorm(20,0,3), rnorm(20,5,10), rnorm(20,15,15))
xy.df <- cbind(x, y)
colnames(xy.df) <- c("x", "y")
xy.df <- as.data.frame(xy.df)
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point()+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
theme_minimal()
x <- rnorm(60,0,1)
beta1 <- rnorm(1,4,2)
beta0 <- rnorm(1,1,1)
x <- sort(x)
y <- beta0+beta1*x + c(rnorm(20,0,3), rnorm(20,5,10), rnorm(20,20,15))
xy.df <- cbind(x, y)
colnames(xy.df) <- c("x", "y")
xy.df <- as.data.frame(xy.df)
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point()+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.align='center', out.width="63%", warning=FALSE, fig.retina=3)
#install.packages( 'tidyverse' )
#install.packages( 'readxl' )
library( tidyverse, quietly=T, warn.conflicts = F )
library( knitr, quietly=T, warn.conflicts = F )
library( readxl, quietly=T, warn.conflicts = F )
#library( tufte, quietly=T, warn.conflicts = F )
library( quantmod, quietly=T, warn.conflicts = F )
library(kableExtra)
#library(gganimate)
#library(rvest)
#library(jsonlite)
#library(listviewer)
library(janitor)
hook1 <- function(x){ gsub("```\n*```r*\n*", "", x) }
hook2 <- function(x){ gsub("```\n+```\n", "", x) }
knit_hooks$set(document = hook2)
#download.file("http://www.openintro.org/stat/data/mlb11.RData", destfile = "mlb11.RData")
load("mlb11.RData")
#items <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-05/items.csv')
#video_games <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-07-30/video_games.csv")
x <- rnorm(20,0,1)
beta1 <- rnorm(1,4,2)
beta0 <- rnorm(1,1,1)
y <- beta0+beta1*x + rnorm(20,0,3)
xy.df <- cbind(x, y)
colnames(xy.df) <- c("x", "y")
xy.df <- as.data.frame(xy.df)
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point(size=4)+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
#theme_bw()+
theme(axis.title = element_text(size=24),
axis.text = element_text(size=18),
title = element_text(size=24))+
theme_minimal()
#Lab: http://htmlpreview.github.io/?https://github.com/andrewpbray/oiLabs-base-R/blob/master/simple_regression/simple_regression.html
mlb11.p <- mlb11 %>%
ggplot(aes(x=at_bats, y=runs, label=team))+
geom_point(size=2)+
xlab("at-bats")+
ggtitle("MLB 2011")+
theme_minimal()+
theme(
title = element_text(size=14),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
axis.text.x = element_text(size=14),
axis.text.y = element_text(size=14)
)
mlb11.p
data(starwars)
starwars <- starwars %>%
dplyr::filter(!(is.na(mass)), !(is.na(height)))
starwars.p <- starwars %>%
ggplot(aes(x=height,
y=mass))+
geom_point(size=2)+
xlab("Height (cm)")+
ylab("Mass (kg)")+
ggtitle("Star Wars Characters")+
theme_minimal()+
theme(
title = element_text(size=14),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14),
axis.text.x = element_text(size=14),
axis.text.y = element_text(size=14)
)
starwars.p
mlb.corr <- cor(mlb11$runs, mlb11$at_bats)
mlb11.p.lab <- mlb11.p +
geom_label(aes(x=5460, y=825, label=paste("R=", round(mlb.corr, 4))), size=6)
mlb11.p.lab
sw.corr <- cor(starwars$mass, starwars$height)
starwars.p.lab <- starwars.p +
geom_label(aes(x=100, y=1000, label=paste("R=", round(sw.corr, 4))), size=6)
starwars.p.lab
xy.lm <- lm(y~x, data=xy.df)
xy.df <- xy.df %>%
mutate(fitted = fitted(xy.lm),
residual = round(residuals(xy.lm), 3))
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point(size=4)+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
geom_segment(aes(x = x, y = y,
xend = x, yend = fitted, color="red"))+
#geom_label(aes(label=residual, x=x, y=fitted + 0.5*residual, color="red"))+
theme(axis.title = element_text(size=18),
axis.text = element_text(size=14),
title = element_text(size=20),
legend.position = "none")
mlb11.p.lab.lm <- mlb11.p.lab+
geom_smooth(method='lm', se=FALSE)
mlb11.p.lab.lm
mlb.lm <- summary(lm(runs ~ at_bats, data=mlb11))
mlb.lm$residuals %>%
as.data.frame() %>%
ggplot(aes(x=.), bins=25)+
geom_histogram()+
ggtitle("Histogram of Regression Residuals")+
theme_minimal()
starwars.p.lab.lm <- starwars.p.lab+
geom_smooth(method='lm', se=FALSE)
starwars.p.lab.lm
sw.lm <- summary(lm(mass ~ height, data=starwars))
sw.lm$residuals %>%
as.data.frame() %>%
ggplot(aes(x=.), bins=45)+
geom_histogram()+
ggtitle("Histogram of Regression Residuals")+
theme_minimal()
mlb11.p.lab.lm
starwars.p.lab.lm
mlb11.p.lab.lm+
annotate("text", x=5650, y=540, label="5650", color="red", size=6, vjust=1)+
coord_cartesian(expand=F, clip = "off")
mlb11.p+
xlim(5000, 9000)+
ylim(540, 3000)+
geom_smooth(method='lm', se=FALSE, fullrange=TRUE)+
annotate("text", x=8500, y=540, label="8,500", color="red", size=6, vjust=1)+
coord_cartesian(expand=F, clip = "off")
mlb.lm.multi <- summary(lm(runs ~ at_bats + bat_avg + homeruns, data=mlb11))
mlb.lm.multi
ls(mlb.lm.multi)
mlb.lm$residuals %>%
as.data.frame() %>%
ggplot(aes(x=.), bins=35)+
geom_histogram()+
ggtitle("Histogram of Regression Residuals")+
theme_minimal()
mlb.lm$residuals %>%
as.data.frame() %>%
ggplot(aes(x=.), bins=25)+
geom_histogram()+
ggtitle("Histogram of Regression Residuals")+
theme_minimal()
?starwars
glimpse(starwars)
length(unique(starwars$species))
ls(mlb.lm.multi)
### Does the time it takes to complete a handheld game affect its ratings?
video_games <- read_csv("video_games.csv")
video_games <- video_games %>%
clean_names()
install.packages("astsa")
library(asta)
library(astsa)
glimpse(astsa)
data(astsa)
data(austres)
glimpse(austres)
ls(austres)
plot(austres, xlab="Year",ylab="Number of Australian Residents", main="Australian Population in thousand")
plot(austres, xlab="Year",ylab="Number of Australian Residents", main="Australian Population in thousand", type="p")
data("EuStockMarkets")
glimpse(EuStockMarkets)
EuStockMarkets
plot(EuStockMarkets)
data("JohnsonJohnson")
plot(JohnsonJohnson)
plot(JohnsonJohnson, type="p")
?JohnsonJohnson
plot(JohnsonJohnson, type="p", ylab="Quarterly Earnings at Johnson & Johnson")
plot(JohnsonJohnson, type="p", ylab="Quarterly Earnings at\n Johnson & Johnson")
plot(JohnsonJohnson, type="p", main="Quarterly Earnings at Johnson & Johnson", ylab="Earnings (USD) per Share")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.align='center', out.width="63%", warning=FALSE, fig.retina=3)
x <- rnorm(20,0,1)
beta1 <- rnorm(1,4,2)
beta0 <- rnorm(1,1,1)
y <- beta0+beta1*x + rnorm(20,0,3)
xy.df <- cbind(x, y)
colnames(xy.df) <- c("x", "y")
xy.df <- as.data.frame(xy.df)
xy.lm <- lm(y~x, data=xy.df)
xy.df <- xy.df %>%
mutate(fitted = fitted(xy.lm),
residual = round(residuals(xy.lm), 3))
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point(size=4)+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
# geom_segment(aes(x = x, y = y,
#                 xend = x, yend = fitted, color="red"))+
#geom_label(aes(label=residual, x=x, y=fitted + 0.5*residual, color="red"))+
theme(axis.title = element_text(size=18),
axis.text = element_text(size=14),
title = element_text(size=20),
legend.position = "none")
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point(size=4)+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
# geom_segment(aes(x = x, y = y,
#                 xend = x, yend = fitted, color="red"))+
#geom_label(aes(label=residual, x=x, y=fitted + 0.5*residual, color="red"))+
theme(axis.title = element_text(size=18),
axis.text = element_text(size=14),
title = element_text(size=20),
legend.position = "none")
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point(size=4)+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
# geom_segment(aes(x = x, y = y,
#                 xend = x, yend = fitted, color="red"))+
#geom_label(aes(label=residual, x=x, y=fitted + 0.5*residual, color="red"))+
theme(#axis.title = element_text(size=18),
#axis.text = element_text(size=14),
#title = element_text(size=20),
legend.position = "none")
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point()+#size=4)+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
# geom_segment(aes(x = x, y = y,
#                 xend = x, yend = fitted, color="red"))+
#geom_label(aes(label=residual, x=x, y=fitted + 0.5*residual, color="red"))+
theme(#axis.title = element_text(size=18),
#axis.text = element_text(size=14),
#title = element_text(size=20),
legend.position = "none")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.align='center', out.width="63%", warning=FALSE, fig.retina=3)
x <- rnorm(20,0,1)
beta1 <- rnorm(1,4,2)
beta0 <- rnorm(1,1,1)
y <- beta0+beta1*x + rnorm(20,0,3)
xy.df <- cbind(x, y)
colnames(xy.df) <- c("x", "y")
xy.df <- as.data.frame(xy.df)
xy.df %>%
ggplot(aes(x=x, y=y))+
geom_point()+#size=4)+
ggtitle("Scatterplot")+
xlab("Explanatory (Independent) Variable")+
ylab("Dependent Variable (Response)")+
geom_smooth(method="lm", se=FALSE)+
# geom_segment(aes(x = x, y = y,
#                 xend = x, yend = fitted, color="red"))+
#geom_label(aes(label=residual, x=x, y=fitted + 0.5*residual, color="red"))+
theme(#axis.title = element_text(size=18),
#axis.text = element_text(size=14),
#title = element_text(size=20),
legend.position = "none")
data("Titanic")
?Titanic
data("titanic_test")
library(titanic)
data("titanic_test")
glimpse(titanic_test)
library(janitor)
data("iris")
glimpse(iris)
?pivot_wider
?pivot_longer
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.align='center', out.width="63%", warning=FALSE, fig.retina=3)
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=expression(mu), vjust=1, size=10)+
annotate("text", x=0.5, y=0.26, label=expression(sigma), size=10)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
a <- rnorm(100000, 0, 1.5)
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=1)+
xlab("") +
ylab("") +
theme_minimal()+
annotate("text", x=1, y=0, label="Z = 1", vjust=2, size=6)+
coord_cartesian(expand=F, clip = "off")
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=1)+
xlab("") +
ylab("") +
theme_minimal()+
annotate("text", x=1, y=0, label="X = 1.5", vjust=2, size=6)+
coord_cartesian(expand=F, clip = "off")
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=expression(mu=0), vjust=1, size=10)+
annotate("text", x=0.5, y=0.26, label=expression(sigma=1), size=10)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=expression(mu,"=0"), vjust=1, size=10)+
annotate("text", x=0.5, y=0.26, label=expression(sigma,"=1"), size=10)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=paste(expression(mu),"=0"), vjust=1, size=10)+
annotate("text", x=0.5, y=0.26, label=paste(expression(sigma),"=1"), size=10)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=expression(mu), vjust=1, size=10)+
annotate("text", x=1, y=0, label="=0", vjust=1, size=10)+
annotate("text", x=0.5, y=0.26, label=expression(sigma), size=10)+
annotate("text", x=1.5, y=0.26, label="=1", size=10)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=expression(mu), vjust=1, size=8)+
annotate("text", x=1, y=0, label="=0", vjust=1, size=8)+
annotate("text", x=0.5, y=0.36, label=expression(sigma), size=8)+
annotate("text", x=1.5, y=0.36, label="=1", size=8)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=expression(mu), vjust=1, size=8)+
annotate("text", x=1, y=0, label="=0", vjust=1, size=8)+
annotate("text", x=0.5, y=0.27, label=expression(sigma), size=8)+
annotate("text", x=1.5, y=0.27, label="=1", size=8)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
a <- rnorm(1000000, 0, 1)
par(mar=c(2,2,2,2))
a %>%
as.data.frame() %>%
ggplot(aes(x=.)) +
geom_density() +
geom_vline(xintercept=0)+
geom_segment(aes(x = 0, y = 0.25, xend = 0.99, yend = 0.25))+
annotate("text", label="")+
xlab("") +
ylab("") +
theme_minimal()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
annotate("text", x=0, y=0, label=expression(mu), vjust=1, size=8)+
annotate("text", x=0.5, y=0, label="=0", vjust=1, size=8)+
annotate("text", x=0.5, y=0.27, label=expression(sigma), size=8)+
annotate("text", x=1, y=0.27, label="=1", size=8)+
coord_cartesian(expand=F, clip = "off") # added clip = "off"
