title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white")+
annotate("text",1.96,-0.03,label="1.96")+
annotate("text",-1.96,-0.03,label="-1.96")+
annotate("text",c(-1.9, 2.05),
rep(-0.03,2),label=expression(sigma))+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
ShadedDensityCenter(frame = z, xvar = "a",
boundaries = c(threshold2, threshold1),
title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white")+
annotate("text",1.96,-0.03,label="1.96")+
annotate("text",-1.96,-0.03,label="-1.96")+
annotate("text",c(-1.5, 2.25),
rep(-0.03,2),label=expression(sigma))+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
ShadedDensityCenter(frame = z, xvar = "a",
boundaries = c(threshold2, threshold1),
title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white")+
annotate("text",1.96,-0.03,label="1.96")+
annotate("text",-1.96,-0.03,label="-1.96")+
annotate("text",c(-1.7, 2.45),
rep(-0.03,2),label=expression(sigma/sqrt(n)))+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
ShadedDensityCenter(frame = z, xvar = "a",
boundaries = c(threshold2, threshold1),
title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white")+
annotate("text",1.8,-0.03,label="1.96")+
annotate("text",-2.1,-0.03,label="-1.96")+
annotate("text",c(-1.7, 2.45),
rep(-0.03,2),label=expression(sigma/sqrt(n)))+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
ShadedDensityCenter(frame = z, xvar = "a",
boundaries = c(threshold2, threshold1),
title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white")+
annotate("text",1.8,-0.03,label="1.96")+
annotate("text",-2.2,-0.03,label="-1.96")+
annotate("text",c(-1.5, 2.65),
rep(-0.03,2),label=expression(sigma/sqrt(n)))+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
ShadedDensityCenter(frame = z, xvar = "a",
boundaries = c(threshold2, threshold1),
title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white")+
annotate("text",1.8,-0.03,label="1.96")+
annotate("text",-2.2,-0.03,label="-1.96")+
annotate("text",c(-1.4, 2.65),
rep(-0.03,2),label=expression(sigma/sqrt(n)))+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
ShadedDensityCenter(frame = z, xvar = "a",
boundaries = c(threshold2, threshold1),
title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white")+
annotate("text",1.8,-0.03,label="1.96")+
annotate("text",-2.2,-0.03,label="-1.96")+
annotate("text",c(-1.3, 2.65),
rep(-0.03,2),label=expression(sigma/sqrt(n)))+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
?ShadedDensityCenter
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.align='center', out.width="63%", warning=FALSE, fig.retina=3)
download.file("http://www.openintro.org/stat/data/mlb11.RData", destfile = "mlb11.RData")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.align='center', out.width="53%", warning=FALSE, fig.retina = 3)
source("http://www.openintro.org/stat/data/mlb11.RData")
read.table("http://www.openintro.org/stat/data/mlb11.RData")
load(url("http://www.openintro.org/stat/data/mlb11.RData"))
mlb.lm <- summary(lm(runs ~ at_bats, data=mlb11))
mlb.lm$coef
glimpse(mlb11)
library(WVPlots)
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
ShadedDensityCenter(frame = z, xvar = "a",
boundaries = c(threshold2, threshold1),
shading = "red",
title = "",
annotate_area=FALSE)+
xlab("")+
ylab("")+
geom_hline(yintercept=0)+
annotate("text",0,0.2,label="95%",color="white", size=17)+
annotate("text",1.5,-0.03,label="1.96", size=10, col="red")+
annotate("text",-3,-0.03,label="-1.96", size=10, col="red")+
annotate("text",c(-1.4, 2.95),
rep(-0.03,2),label=expression(sigma/sqrt(n)), size=10, col="red")+
annotate("text",0,-0.03,label=expression(bar(x)), size=10)+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="darkblue", fill="lightblue")
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="darkblue", fill="lightblue")+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a <- rnorm(1000000)
z <- data.frame(seq(1000000), a)
#threshold1 <- quantile(z[, 2], prob = 0.975)[[1]]
#threshold2 <- quantile(z[, 2], prob = 0.025)[[1]]
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="darkblue", fill="lightblue")+
annotate("text",0,-0.03,label=expression(bar(x)))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="darkblue", fill="lightblue")+
annotate("text",0,-0.03,label=expression(bar(x)_1))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="darkblue", fill="lightblue")+
annotate("text",0,-0.03,label=expression(bar(x)_1))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="darkblue", fill="lightblue")+
annotate("text",0,-0.03,label=expression(bar(x)[1]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
,
p <- a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5")+
annotate("text",0,-0.03,label=expression(bar(x)[1]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
p + geom_density(aes(x=b), color="#7570b3", fill="#8da0cb")+
annotate("text",0,-0.03,label=expression(bar(x)[2]))
b <- rnorm(1000000, 5)
p + geom_density(aes(x=b), color="#7570b3", fill="#8da0cb")+
annotate("text",0,-0.03,label=expression(bar(x)[2]))
=
p <- a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(bar(x)[1]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
p + geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",0,-0.03,label=expression(bar(x)[2]))
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",0,-0.03,label=expression(bar(x)[2]))+
annotate("text",0,-0.03,label=expression(bar(x)[1]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",0,-0.03,label=expression(bar(x)[2]))+
annotate("text",5,-0.03,label=expression(bar(x)[1]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(bar(x)[1]))+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,-0.03,label=expression(bar(x)[2]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]))+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,-0.03,label=expression(mu[2]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,-0.03,label=expression(mu[2]))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,-0.03,label=expression(mu[2], size=8))+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,-0.03,label=expression(mu[2]), size=8)+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
annotate("text",0,0.1,label="Population 1", size=8)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,0.1,label="Population 2", size=8)+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
annotate("text",0,0.4,label="Population 1", size=7)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,0.4,label="Population 2", size=7)+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
annotate("text",0,0.4,label="Population 1", size=7)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,0.4,label="Population 2", size=7)+
annotate("text",5,-0.03,label=expression(mu[2]), size=8)+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
annotate("text",0,0.43,label="Population 1", size=7)+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,0.43,label="Population 2", size=7)+
annotate("text",5,-0.03,label=expression(mu[2]), size=8)+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8)+
annotate("text",0,0.43,label="Population 1", size=7, color="#1b9e77")+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,0.43,label="Population 2", size=7)+
annotate("text",5,-0.03,label=expression(mu[2]), size=8)+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8, color="#1b9e77")+
annotate("text",0,0.43,label="Population 1", size=7, color="#1b9e77")+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,0.43,label="Population 2", size=7, color="#8da0cb")+
annotate("text",5,-0.03,label=expression(mu[2]), size=8, color="#8da0cb")+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
a %>%
as.data.frame() %>%
ggplot(aes(x=.))+
geom_density(color="#1b9e77", fill="#66c2a5", alpha=0.5)+
annotate("text",0,-0.03,label=expression(mu[1]), size=8, color="#1b9e77")+
annotate("text",0,0.43,label="Population 1", size=7, color="#1b9e77")+
geom_density(aes(x=b), color="#7570b3", fill="#8da0cb", alpha=0.5)+
annotate("text",5,0.43,label="Population 2", size=7, color="#7570b3")+
annotate("text",5,-0.03,label=expression(mu[2]), size=8, color="#7570b3")+
theme_minimal()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
version
